> tbl <- tibble(x = 1:2, y = 1:2)

setting column to NULL makes it unavailable
===========================================

> mutate(tbl, y = NULL, a = sum(y))
Error: `mutate()` argument `a` errored
x object 'y' not found
i `a` is sum(y)

> mutate(group_by(tbl, x), y = NULL, a = sum(y))
Error: `mutate()` argument `a` errored
x object 'y' not found
i `a` is sum(y)
i The error occured in group 1


incompatible column type
========================

> mutate(tibble(x = 1), y = mean)
Error: `mutate()` argument `y` must be a vector
i `y` is mean
x Result should be a vector, not a function


Unsupported type
================

> df <- tibble(g = c(1, 1, 2, 2, 2), x = 1:5)
> mutate(df, out = env(a = 1))
Error: `mutate()` argument `out` must be a vector
i `out` is env(a = 1)
x Result should be a vector, not an environment

> mutate(group_by(df, g), out = env(a = 1))
Error: `mutate()` argument `out` must be a vector
i `out` is env(a = 1)
x Result should be a vector, not an environment
i The error occured in group 1


result is sometimes NULL
========================

> mutate(group_by(tibble(a = 1:3, b = 4:6), a), if (a == 1) NULL else "foo")
Error: `mutate()` argument `..1` must return compatible vectors across groups
i `..1` is if (a == 1) NULL else "foo"
i Cannot combine NULL and non NULL results


incompatible types across groups
================================

> mutate(group_by(data.frame(x = rep(1:5, each = 3)), x), val = ifelse(x < 3,
+   "foo", 2))
Error: `mutate()` argument `val` must return compatible vectors across groups
x Error from vec_c() : No common type for `..1` <character> and `..3` <double>.
i `val` is ifelse(x < 3, "foo", 2)


incompatible size
=================

> mutate(data.frame(x = c(2, 2, 3, 3)), int = 1:5)
Error: `mutate()` argument `int` must be recyclable
i `int` is 1:5
x `x` can't be recycled to size 4.
x It must be size 4 or 1, not 5.

> mutate(group_by(data.frame(x = c(2, 2, 3, 3)), x), int = 1:5)
Error: `mutate()` argument `int` must be recyclable
i `int` is 1:5
x `x` can't be recycled to size 2.
x It must be size 2 or 1, not 5.
i The error occured in group 2


.data pronoun
=============

> mutate(tibble(a = 1), c = .data$b)
Error: `mutate()` argument `c` errored
x Column `b` not found in `.data`
i `c` is .data$b

> mutate(group_by(tibble(a = 1:3), a), c = .data$b)
Error: `mutate()` argument `c` errored
x Column `b` not found in `.data`
i `c` is .data$b

